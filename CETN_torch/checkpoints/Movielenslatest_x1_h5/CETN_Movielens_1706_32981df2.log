2023-10-20 21:22:28,874 P735258 INFO Params: {
    "V_net_dropout": "0.2",
    "W_net_dropout": "0.4",
    "alpha": "0.4",
    "batch_norm": "False",
    "batch_size": "10000",
    "beta": "0.3",
    "cl_temperature": "0.2",
    "data_format": "csv",
    "data_root": "../../../data/",
    "dataset_id": "Movielenslatest_x1_h5",
    "debug_mode": "False",
    "delta": "0.6",
    "early_stop_patience": "2",
    "embedding_dim": "20",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eps": "1e-05",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'float', 'name': ['user_id', 'item_id', 'tag_id'], 'type': 'categorical'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "fi_hidden_units": "[400]",
    "gpu": "3",
    "group_id": "None",
    "hidden_activations": "['dice', 'dice', 'dice']",
    "label_col": "{'dtype': 'float', 'name': 'label'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "2",
    "model": "CETN",
    "model_id": "CETN_Movielens_1706_32981df2",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "perturbed": "False",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2023",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "../../../data/MovielensLatest_x1_h5/test.h5",
    "through": "True",
    "train_data": "../../../data/MovielensLatest_x1_h5/train.h5",
    "use_features": "None",
    "valid_data": "../../../data/MovielensLatest_x1_h5/valid.h5",
    "verbose": "1",
    "w_hidden_units": "[800]"
}
2023-10-20 21:22:28,874 P735258 INFO Set up feature processor...
2023-10-20 21:22:28,874 P735258 WARNING Skip rebuilding ../../../data/Movielenslatest_x1_h5/feature_map.json. Please delete it manually if rebuilding is required.
2023-10-20 21:22:28,874 P735258 INFO Load feature_map from json: ../../../data/Movielenslatest_x1_h5/feature_map.json
2023-10-20 21:22:28,874 P735258 INFO Set column index...
2023-10-20 21:22:28,874 P735258 INFO Feature specs: {
    "item_id": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 22574, 'vocab_size': 22575}",
    "tag_id": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 49658, 'vocab_size': 49659}",
    "user_id": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 16361, 'vocab_size': 16362}"
}
2023-10-20 21:22:33,188 P735258 INFO Total number of parameters: 2003526.
2023-10-20 21:22:33,189 P735258 INFO Loading data...
2023-10-20 21:22:33,189 P735258 INFO Loading data from h5: ../../../data/Movielenslatest_x1_h5/train.h5
2023-10-20 21:22:33,219 P735258 INFO Train samples: total/1404801, blocks/1
2023-10-20 21:22:33,219 P735258 INFO Loading data from h5: ../../../data/Movielenslatest_x1_h5/valid.h5
2023-10-20 21:22:33,225 P735258 INFO Validation samples: total/401372, blocks/1
2023-10-20 21:22:33,225 P735258 INFO Loading train and validation data done.
2023-10-20 21:22:33,225 P735258 INFO Start training: 141 batches/epoch
2023-10-20 21:22:33,225 P735258 INFO ************ Epoch=1 start ************
2023-10-20 21:22:37,010 P735258 INFO Train loss: 1.470778
2023-10-20 21:22:37,010 P735258 INFO Evaluation @epoch 1 - batch 141:
2023-10-20 21:22:38,501 P735258 INFO ===
2023-10-20 21:22:38,501 P735258 INFO [Metrics] AUC: 0.909965 - logloss: 0.397718
2023-10-20 21:22:38,501 P735258 INFO Save best model: monitor(max)=0.512247
2023-10-20 21:22:38,698 P735258 INFO ************ Epoch=1 end ************
2023-10-20 21:22:42,412 P735258 INFO Train loss: 1.010957
2023-10-20 21:22:42,412 P735258 INFO Evaluation @epoch 2 - batch 141:
2023-10-20 21:22:43,909 P735258 INFO ===
2023-10-20 21:22:43,909 P735258 INFO [Metrics] AUC: 0.926472 - logloss: 0.375157
2023-10-20 21:22:43,909 P735258 INFO Save best model: monitor(max)=0.551315
2023-10-20 21:22:44,117 P735258 INFO ************ Epoch=2 end ************
2023-10-20 21:22:47,833 P735258 INFO Train loss: 0.973779
2023-10-20 21:22:47,833 P735258 INFO Evaluation @epoch 3 - batch 141:
2023-10-20 21:22:49,311 P735258 INFO ===
2023-10-20 21:22:49,311 P735258 INFO [Metrics] AUC: 0.921643 - logloss: 0.367424
2023-10-20 21:22:49,311 P735258 INFO Save best model: monitor(max)=0.554219
2023-10-20 21:22:49,509 P735258 INFO ************ Epoch=3 end ************
2023-10-20 21:22:53,283 P735258 INFO Train loss: 0.972994
2023-10-20 21:22:53,284 P735258 INFO Evaluation @epoch 4 - batch 141:
2023-10-20 21:22:54,845 P735258 INFO ===
2023-10-20 21:22:54,845 P735258 INFO [Metrics] AUC: 0.928199 - logloss: 0.348926
2023-10-20 21:22:54,845 P735258 INFO Save best model: monitor(max)=0.579273
2023-10-20 21:22:55,058 P735258 INFO ************ Epoch=4 end ************
2023-10-20 21:22:58,825 P735258 INFO Train loss: 0.988286
2023-10-20 21:22:58,825 P735258 INFO Evaluation @epoch 5 - batch 141:
2023-10-20 21:23:00,434 P735258 INFO ===
2023-10-20 21:23:00,434 P735258 INFO [Metrics] AUC: 0.930653 - logloss: 0.321749
2023-10-20 21:23:00,434 P735258 INFO Save best model: monitor(max)=0.608904
2023-10-20 21:23:00,629 P735258 INFO ************ Epoch=5 end ************
2023-10-20 21:23:04,226 P735258 INFO Train loss: 0.995102
2023-10-20 21:23:04,226 P735258 INFO Evaluation @epoch 6 - batch 141:
2023-10-20 21:23:05,872 P735258 INFO ===
2023-10-20 21:23:05,872 P735258 INFO [Metrics] AUC: 0.935907 - logloss: 0.303990
2023-10-20 21:23:05,872 P735258 INFO Save best model: monitor(max)=0.631917
2023-10-20 21:23:06,061 P735258 INFO ************ Epoch=6 end ************
2023-10-20 21:23:09,716 P735258 INFO Train loss: 0.985639
2023-10-20 21:23:09,716 P735258 INFO Evaluation @epoch 7 - batch 141:
2023-10-20 21:23:11,226 P735258 INFO ===
2023-10-20 21:23:11,226 P735258 INFO [Metrics] AUC: 0.940354 - logloss: 0.293003
2023-10-20 21:23:11,226 P735258 INFO Save best model: monitor(max)=0.647351
2023-10-20 21:23:11,430 P735258 INFO ************ Epoch=7 end ************
2023-10-20 21:23:15,132 P735258 INFO Train loss: 0.983894
2023-10-20 21:23:15,132 P735258 INFO Evaluation @epoch 8 - batch 141:
2023-10-20 21:23:16,761 P735258 INFO ===
2023-10-20 21:23:16,761 P735258 INFO [Metrics] AUC: 0.947054 - logloss: 0.277667
2023-10-20 21:23:16,761 P735258 INFO Save best model: monitor(max)=0.669387
2023-10-20 21:23:16,939 P735258 INFO ************ Epoch=8 end ************
2023-10-20 21:23:20,792 P735258 INFO Train loss: 0.971803
2023-10-20 21:23:20,793 P735258 INFO Evaluation @epoch 9 - batch 141:
2023-10-20 21:23:22,551 P735258 INFO ===
2023-10-20 21:23:22,551 P735258 INFO [Metrics] AUC: 0.951109 - logloss: 0.271465
2023-10-20 21:23:22,551 P735258 INFO Save best model: monitor(max)=0.679644
2023-10-20 21:23:22,761 P735258 INFO ************ Epoch=9 end ************
2023-10-20 21:23:26,509 P735258 INFO Train loss: 0.972638
2023-10-20 21:23:26,509 P735258 INFO Evaluation @epoch 10 - batch 141:
2023-10-20 21:23:28,113 P735258 INFO ===
2023-10-20 21:23:28,113 P735258 INFO [Metrics] AUC: 0.956055 - logloss: 0.240393
2023-10-20 21:23:28,114 P735258 INFO Save best model: monitor(max)=0.715662
2023-10-20 21:23:28,314 P735258 INFO ************ Epoch=10 end ************
2023-10-20 21:23:32,047 P735258 INFO Train loss: 0.965370
2023-10-20 21:23:32,048 P735258 INFO Evaluation @epoch 11 - batch 141:
2023-10-20 21:23:33,727 P735258 INFO ===
2023-10-20 21:23:33,727 P735258 INFO [Metrics] AUC: 0.959809 - logloss: 0.245253
2023-10-20 21:23:33,727 P735258 INFO Monitor(max)=0.714557 STOP!
2023-10-20 21:23:33,727 P735258 INFO Reduce learning rate on plateau: 0.000100
2023-10-20 21:23:33,918 P735258 INFO ************ Epoch=11 end ************
2023-10-20 21:23:37,606 P735258 INFO Train loss: 0.846206
2023-10-20 21:23:37,607 P735258 INFO Evaluation @epoch 12 - batch 141:
2023-10-20 21:23:39,448 P735258 INFO ===
2023-10-20 21:23:39,448 P735258 INFO [Metrics] AUC: 0.970250 - logloss: 0.225450
2023-10-20 21:23:39,448 P735258 INFO Save best model: monitor(max)=0.744799
2023-10-20 21:23:39,621 P735258 INFO ************ Epoch=12 end ************
2023-10-20 21:23:43,311 P735258 INFO Train loss: 0.736362
2023-10-20 21:23:43,311 P735258 INFO Evaluation @epoch 13 - batch 141:
2023-10-20 21:23:44,957 P735258 INFO ===
2023-10-20 21:23:44,957 P735258 INFO [Metrics] AUC: 0.971705 - logloss: 0.326166
2023-10-20 21:23:44,957 P735258 INFO Monitor(max)=0.645538 STOP!
2023-10-20 21:23:44,957 P735258 INFO Reduce learning rate on plateau: 0.000010
2023-10-20 21:23:45,165 P735258 INFO ************ Epoch=13 end ************
2023-10-20 21:23:48,877 P735258 INFO Train loss: 0.690243
2023-10-20 21:23:48,877 P735258 INFO Evaluation @epoch 14 - batch 141:
2023-10-20 21:23:50,413 P735258 INFO ===
2023-10-20 21:23:50,413 P735258 INFO [Metrics] AUC: 0.972239 - logloss: 0.199586
2023-10-20 21:23:50,413 P735258 INFO Save best model: monitor(max)=0.772654
2023-10-20 21:23:50,618 P735258 INFO ************ Epoch=14 end ************
2023-10-20 21:23:54,419 P735258 INFO Train loss: 0.684721
2023-10-20 21:23:54,420 P735258 INFO Evaluation @epoch 15 - batch 141:
2023-10-20 21:23:55,987 P735258 INFO ===
2023-10-20 21:23:55,987 P735258 INFO [Metrics] AUC: 0.971531 - logloss: 0.207653
2023-10-20 21:23:55,988 P735258 INFO Monitor(max)=0.763878 STOP!
2023-10-20 21:23:55,988 P735258 INFO Reduce learning rate on plateau: 0.000001
2023-10-20 21:23:56,172 P735258 INFO ************ Epoch=15 end ************
2023-10-20 21:23:59,873 P735258 INFO Train loss: 0.681122
2023-10-20 21:23:59,873 P735258 INFO Evaluation @epoch 16 - batch 141:
2023-10-20 21:24:01,546 P735258 INFO ===
2023-10-20 21:24:01,547 P735258 INFO [Metrics] AUC: 0.970444 - logloss: 0.216607
2023-10-20 21:24:01,547 P735258 INFO Monitor(max)=0.753838 STOP!
2023-10-20 21:24:01,547 P735258 INFO Reduce learning rate on plateau: 0.000001
2023-10-20 21:24:01,547 P735258 INFO ********* Epoch==16 early stop *********
2023-10-20 21:24:01,722 P735258 INFO Training finished.
2023-10-20 21:24:01,723 P735258 INFO Load best model: /root/autodl-tmp/model_zoo/CETN/CETN_torch/checkpoints/Movielenslatest_x1_h5/CETN_Movielens_1706_32981df2.model
2023-10-20 21:24:01,729 P735258 INFO ****** Validation evaluation ******
2023-10-20 21:24:03,205 P735258 INFO ===
2023-10-20 21:24:03,205 P735258 INFO [Metrics] logloss: 0.199586 - AUC: 0.972239
2023-10-20 21:24:03,261 P735258 INFO ******** Test evaluation ********
2023-10-20 21:24:03,261 P735258 INFO Loading data...
2023-10-20 21:24:03,261 P735258 INFO Loading data from h5: ../../../data/Movielenslatest_x1_h5/test.h5
2023-10-20 21:24:03,264 P735258 INFO Test samples: total/200686, blocks/1
2023-10-20 21:24:03,264 P735258 INFO Loading test data done.
2023-10-20 21:24:04,258 P735258 INFO ===
2023-10-20 21:24:04,258 P735258 INFO [Metrics] logloss: 0.202106 - AUC: 0.972029
