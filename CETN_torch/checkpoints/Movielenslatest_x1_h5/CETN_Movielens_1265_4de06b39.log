2023-10-20 19:10:17,182 P686991 INFO Params: {
    "V_net_dropout": "0.2",
    "W_net_dropout": "0.4",
    "alpha": "0.3",
    "batch_norm": "False",
    "batch_size": "10000",
    "beta": "0.4",
    "cl_temperature": "0.1",
    "data_format": "csv",
    "data_root": "../../../data/",
    "dataset_id": "Movielenslatest_x1_h5",
    "debug_mode": "False",
    "delta": "0.7",
    "early_stop_patience": "2",
    "embedding_dim": "20",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eps": "1e-05",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'float', 'name': ['user_id', 'item_id', 'tag_id'], 'type': 'categorical'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "fi_hidden_units": "[400]",
    "gpu": "0",
    "group_id": "None",
    "hidden_activations": "['dice', 'dice', 'dice']",
    "label_col": "{'dtype': 'float', 'name': 'label'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "2",
    "model": "CETN",
    "model_id": "CETN_Movielens_1265_4de06b39",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_regularizer": "0",
    "num_workers": "3",
    "optimizer": "adam",
    "perturbed": "False",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2023",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "../../../data/MovielensLatest_x1_h5/test.h5",
    "through": "True",
    "train_data": "../../../data/MovielensLatest_x1_h5/train.h5",
    "use_features": "None",
    "valid_data": "../../../data/MovielensLatest_x1_h5/valid.h5",
    "verbose": "1",
    "w_hidden_units": "[800]"
}
2023-10-20 19:10:17,182 P686991 INFO Set up feature processor...
2023-10-20 19:10:17,182 P686991 WARNING Skip rebuilding ../../../data/Movielenslatest_x1_h5/feature_map.json. Please delete it manually if rebuilding is required.
2023-10-20 19:10:17,182 P686991 INFO Load feature_map from json: ../../../data/Movielenslatest_x1_h5/feature_map.json
2023-10-20 19:10:17,183 P686991 INFO Set column index...
2023-10-20 19:10:17,183 P686991 INFO Feature specs: {
    "item_id": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 22574, 'vocab_size': 22575}",
    "tag_id": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 49658, 'vocab_size': 49659}",
    "user_id": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 16361, 'vocab_size': 16362}"
}
2023-10-20 19:10:21,657 P686991 INFO Total number of parameters: 2003526.
2023-10-20 19:10:21,657 P686991 INFO Loading data...
2023-10-20 19:10:21,657 P686991 INFO Loading data from h5: ../../../data/Movielenslatest_x1_h5/train.h5
2023-10-20 19:10:21,694 P686991 INFO Train samples: total/1404801, blocks/1
2023-10-20 19:10:21,694 P686991 INFO Loading data from h5: ../../../data/Movielenslatest_x1_h5/valid.h5
2023-10-20 19:10:21,699 P686991 INFO Validation samples: total/401372, blocks/1
2023-10-20 19:10:21,699 P686991 INFO Loading train and validation data done.
2023-10-20 19:10:21,699 P686991 INFO Start training: 141 batches/epoch
2023-10-20 19:10:21,699 P686991 INFO ************ Epoch=1 start ************
2023-10-20 19:10:25,524 P686991 INFO Train loss: -0.950223
2023-10-20 19:10:25,525 P686991 INFO Evaluation @epoch 1 - batch 141:
2023-10-20 19:10:27,209 P686991 INFO ===
2023-10-20 19:10:27,209 P686991 INFO [Metrics] AUC: 0.902098 - logloss: 0.396572
2023-10-20 19:10:27,209 P686991 INFO Save best model: monitor(max)=0.505526
2023-10-20 19:10:27,441 P686991 INFO ************ Epoch=1 end ************
2023-10-20 19:10:31,097 P686991 INFO Train loss: -1.524164
2023-10-20 19:10:31,097 P686991 INFO Evaluation @epoch 2 - batch 141:
2023-10-20 19:10:32,616 P686991 INFO ===
2023-10-20 19:10:32,616 P686991 INFO [Metrics] AUC: 0.925265 - logloss: 0.370666
2023-10-20 19:10:32,616 P686991 INFO Save best model: monitor(max)=0.554599
2023-10-20 19:10:32,817 P686991 INFO ************ Epoch=2 end ************
2023-10-20 19:10:36,563 P686991 INFO Train loss: -1.583102
2023-10-20 19:10:36,563 P686991 INFO Evaluation @epoch 3 - batch 141:
2023-10-20 19:10:38,099 P686991 INFO ===
2023-10-20 19:10:38,099 P686991 INFO [Metrics] AUC: 0.927451 - logloss: 0.366675
2023-10-20 19:10:38,099 P686991 INFO Save best model: monitor(max)=0.560777
2023-10-20 19:10:38,297 P686991 INFO ************ Epoch=3 end ************
2023-10-20 19:10:42,012 P686991 INFO Train loss: -1.597287
2023-10-20 19:10:42,012 P686991 INFO Evaluation @epoch 4 - batch 141:
2023-10-20 19:10:43,550 P686991 INFO ===
2023-10-20 19:10:43,550 P686991 INFO [Metrics] AUC: 0.929269 - logloss: 0.353677
2023-10-20 19:10:43,550 P686991 INFO Save best model: monitor(max)=0.575592
2023-10-20 19:10:43,747 P686991 INFO ************ Epoch=4 end ************
2023-10-20 19:10:47,456 P686991 INFO Train loss: -1.604272
2023-10-20 19:10:47,457 P686991 INFO Evaluation @epoch 5 - batch 141:
2023-10-20 19:10:48,977 P686991 INFO ===
2023-10-20 19:10:48,978 P686991 INFO [Metrics] AUC: 0.930325 - logloss: 0.315128
2023-10-20 19:10:48,978 P686991 INFO Save best model: monitor(max)=0.615197
2023-10-20 19:10:49,170 P686991 INFO ************ Epoch=5 end ************
2023-10-20 19:10:52,950 P686991 INFO Train loss: -1.606458
2023-10-20 19:10:52,950 P686991 INFO Evaluation @epoch 6 - batch 141:
2023-10-20 19:10:54,557 P686991 INFO ===
2023-10-20 19:10:54,558 P686991 INFO [Metrics] AUC: 0.932281 - logloss: 0.306612
2023-10-20 19:10:54,558 P686991 INFO Save best model: monitor(max)=0.625669
2023-10-20 19:10:54,783 P686991 INFO ************ Epoch=6 end ************
2023-10-20 19:10:58,585 P686991 INFO Train loss: -1.604062
2023-10-20 19:10:58,585 P686991 INFO Evaluation @epoch 7 - batch 141:
2023-10-20 19:11:00,448 P686991 INFO ===
2023-10-20 19:11:00,448 P686991 INFO [Metrics] AUC: 0.940619 - logloss: 0.281618
2023-10-20 19:11:00,449 P686991 INFO Save best model: monitor(max)=0.659001
2023-10-20 19:11:00,647 P686991 INFO ************ Epoch=7 end ************
2023-10-20 19:11:04,442 P686991 INFO Train loss: -1.606616
2023-10-20 19:11:04,442 P686991 INFO Evaluation @epoch 8 - batch 141:
2023-10-20 19:11:06,219 P686991 INFO ===
2023-10-20 19:11:06,219 P686991 INFO [Metrics] AUC: 0.947246 - logloss: 0.261249
2023-10-20 19:11:06,219 P686991 INFO Save best model: monitor(max)=0.685996
2023-10-20 19:11:06,420 P686991 INFO ************ Epoch=8 end ************
2023-10-20 19:11:10,091 P686991 INFO Train loss: -1.609950
2023-10-20 19:11:10,091 P686991 INFO Evaluation @epoch 9 - batch 141:
2023-10-20 19:11:11,769 P686991 INFO ===
2023-10-20 19:11:11,770 P686991 INFO [Metrics] AUC: 0.951387 - logloss: 0.249694
2023-10-20 19:11:11,770 P686991 INFO Save best model: monitor(max)=0.701693
2023-10-20 19:11:11,995 P686991 INFO ************ Epoch=9 end ************
2023-10-20 19:11:15,688 P686991 INFO Train loss: -1.614309
2023-10-20 19:11:15,688 P686991 INFO Evaluation @epoch 10 - batch 141:
2023-10-20 19:11:17,225 P686991 INFO ===
2023-10-20 19:11:17,225 P686991 INFO [Metrics] AUC: 0.953745 - logloss: 0.242052
2023-10-20 19:11:17,225 P686991 INFO Save best model: monitor(max)=0.711694
2023-10-20 19:11:17,440 P686991 INFO ************ Epoch=10 end ************
2023-10-20 19:11:21,184 P686991 INFO Train loss: -1.614797
2023-10-20 19:11:21,184 P686991 INFO Evaluation @epoch 11 - batch 141:
2023-10-20 19:11:22,748 P686991 INFO ===
2023-10-20 19:11:22,748 P686991 INFO [Metrics] AUC: 0.954368 - logloss: 0.241897
2023-10-20 19:11:22,749 P686991 INFO Save best model: monitor(max)=0.712471
2023-10-20 19:11:22,952 P686991 INFO ************ Epoch=11 end ************
2023-10-20 19:11:26,737 P686991 INFO Train loss: -1.617817
2023-10-20 19:11:26,737 P686991 INFO Evaluation @epoch 12 - batch 141:
2023-10-20 19:11:28,317 P686991 INFO ===
2023-10-20 19:11:28,317 P686991 INFO [Metrics] AUC: 0.956942 - logloss: 0.234891
2023-10-20 19:11:28,318 P686991 INFO Save best model: monitor(max)=0.722050
2023-10-20 19:11:28,525 P686991 INFO ************ Epoch=12 end ************
2023-10-20 19:11:32,305 P686991 INFO Train loss: -1.619837
2023-10-20 19:11:32,305 P686991 INFO Evaluation @epoch 13 - batch 141:
2023-10-20 19:11:34,010 P686991 INFO ===
2023-10-20 19:11:34,011 P686991 INFO [Metrics] AUC: 0.957274 - logloss: 0.231407
2023-10-20 19:11:34,011 P686991 INFO Save best model: monitor(max)=0.725867
2023-10-20 19:11:34,239 P686991 INFO ************ Epoch=13 end ************
2023-10-20 19:11:37,999 P686991 INFO Train loss: -1.622117
2023-10-20 19:11:38,000 P686991 INFO Evaluation @epoch 14 - batch 141:
2023-10-20 19:11:39,622 P686991 INFO ===
2023-10-20 19:11:39,623 P686991 INFO [Metrics] AUC: 0.958697 - logloss: 0.227040
2023-10-20 19:11:39,623 P686991 INFO Save best model: monitor(max)=0.731657
2023-10-20 19:11:39,834 P686991 INFO ************ Epoch=14 end ************
2023-10-20 19:11:43,811 P686991 INFO Train loss: -1.621219
2023-10-20 19:11:43,811 P686991 INFO Evaluation @epoch 15 - batch 141:
2023-10-20 19:11:45,479 P686991 INFO ===
2023-10-20 19:11:45,480 P686991 INFO [Metrics] AUC: 0.958964 - logloss: 0.226780
2023-10-20 19:11:45,480 P686991 INFO Save best model: monitor(max)=0.732184
2023-10-20 19:11:45,699 P686991 INFO ************ Epoch=15 end ************
2023-10-20 19:11:49,517 P686991 INFO Train loss: -1.617536
2023-10-20 19:11:49,518 P686991 INFO Evaluation @epoch 16 - batch 141:
2023-10-20 19:11:51,075 P686991 INFO ===
2023-10-20 19:11:51,075 P686991 INFO [Metrics] AUC: 0.960098 - logloss: 0.223628
2023-10-20 19:11:51,075 P686991 INFO Save best model: monitor(max)=0.736470
2023-10-20 19:11:51,261 P686991 INFO ************ Epoch=16 end ************
2023-10-20 19:11:55,016 P686991 INFO Train loss: -1.621841
2023-10-20 19:11:55,016 P686991 INFO Evaluation @epoch 17 - batch 141:
2023-10-20 19:11:56,596 P686991 INFO ===
2023-10-20 19:11:56,596 P686991 INFO [Metrics] AUC: 0.960820 - logloss: 0.221335
2023-10-20 19:11:56,596 P686991 INFO Save best model: monitor(max)=0.739485
2023-10-20 19:11:56,815 P686991 INFO ************ Epoch=17 end ************
2023-10-20 19:12:00,619 P686991 INFO Train loss: -1.617479
2023-10-20 19:12:00,620 P686991 INFO Evaluation @epoch 18 - batch 141:
2023-10-20 19:12:02,164 P686991 INFO ===
2023-10-20 19:12:02,164 P686991 INFO [Metrics] AUC: 0.960826 - logloss: 0.219994
2023-10-20 19:12:02,165 P686991 INFO Save best model: monitor(max)=0.740832
2023-10-20 19:12:02,363 P686991 INFO ************ Epoch=18 end ************
2023-10-20 19:12:06,166 P686991 INFO Train loss: -1.617728
2023-10-20 19:12:06,166 P686991 INFO Evaluation @epoch 19 - batch 141:
2023-10-20 19:12:07,708 P686991 INFO ===
2023-10-20 19:12:07,708 P686991 INFO [Metrics] AUC: 0.962376 - logloss: 0.221641
2023-10-20 19:12:07,708 P686991 INFO Monitor(max)=0.740736 STOP!
2023-10-20 19:12:07,708 P686991 INFO Reduce learning rate on plateau: 0.000100
2023-10-20 19:12:07,890 P686991 INFO ************ Epoch=19 end ************
2023-10-20 19:12:11,617 P686991 INFO Train loss: -1.738256
2023-10-20 19:12:11,617 P686991 INFO Evaluation @epoch 20 - batch 141:
2023-10-20 19:12:13,172 P686991 INFO ===
2023-10-20 19:12:13,172 P686991 INFO [Metrics] AUC: 0.970260 - logloss: 0.199705
2023-10-20 19:12:13,172 P686991 INFO Save best model: monitor(max)=0.770555
2023-10-20 19:12:13,384 P686991 INFO ************ Epoch=20 end ************
2023-10-20 19:12:17,105 P686991 INFO Train loss: -1.828916
2023-10-20 19:12:17,105 P686991 INFO Evaluation @epoch 21 - batch 141:
2023-10-20 19:12:18,717 P686991 INFO ===
2023-10-20 19:12:18,717 P686991 INFO [Metrics] AUC: 0.971823 - logloss: 0.199278
2023-10-20 19:12:18,718 P686991 INFO Save best model: monitor(max)=0.772545
2023-10-20 19:12:18,903 P686991 INFO ************ Epoch=21 end ************
2023-10-20 19:12:22,621 P686991 INFO Train loss: -1.874844
2023-10-20 19:12:22,621 P686991 INFO Evaluation @epoch 22 - batch 141:
2023-10-20 19:12:24,305 P686991 INFO ===
2023-10-20 19:12:24,306 P686991 INFO [Metrics] AUC: 0.971300 - logloss: 0.246815
2023-10-20 19:12:24,306 P686991 INFO Monitor(max)=0.724485 STOP!
2023-10-20 19:12:24,306 P686991 INFO Reduce learning rate on plateau: 0.000010
2023-10-20 19:12:24,492 P686991 INFO ************ Epoch=22 end ************
2023-10-20 19:12:28,180 P686991 INFO Train loss: -1.902404
2023-10-20 19:12:28,180 P686991 INFO Evaluation @epoch 23 - batch 141:
2023-10-20 19:12:29,795 P686991 INFO ===
2023-10-20 19:12:29,795 P686991 INFO [Metrics] AUC: 0.971313 - logloss: 0.277696
2023-10-20 19:12:29,795 P686991 INFO Monitor(max)=0.693617 STOP!
2023-10-20 19:12:29,795 P686991 INFO Reduce learning rate on plateau: 0.000001
2023-10-20 19:12:29,795 P686991 INFO ********* Epoch==23 early stop *********
2023-10-20 19:12:29,986 P686991 INFO Training finished.
2023-10-20 19:12:29,986 P686991 INFO Load best model: /root/autodl-tmp/model_zoo/CETN/CETN_torch/checkpoints/Movielenslatest_x1_h5/CETN_Movielens_1265_4de06b39.model
2023-10-20 19:12:29,991 P686991 INFO ****** Validation evaluation ******
2023-10-20 19:12:31,554 P686991 INFO ===
2023-10-20 19:12:31,554 P686991 INFO [Metrics] logloss: 0.199278 - AUC: 0.971823
2023-10-20 19:12:31,598 P686991 INFO ******** Test evaluation ********
2023-10-20 19:12:31,598 P686991 INFO Loading data...
2023-10-20 19:12:31,598 P686991 INFO Loading data from h5: ../../../data/Movielenslatest_x1_h5/test.h5
2023-10-20 19:12:31,601 P686991 INFO Test samples: total/200686, blocks/1
2023-10-20 19:12:31,601 P686991 INFO Loading test data done.
2023-10-20 19:12:32,648 P686991 INFO ===
2023-10-20 19:12:32,648 P686991 INFO [Metrics] logloss: 0.199068 - AUC: 0.972041
